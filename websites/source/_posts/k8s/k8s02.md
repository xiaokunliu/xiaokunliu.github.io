---
title: k8s核心术语简述 
category: k8s
date: 2021-06-27 18:44:43
tags: k8s
---

<!-- more -->

### 前言
#### 基本概述
```text
Kubernetes中的大部分概念如Node、Pod、Replication Controller、Service等都可以被看作一种资源对象，几乎所有资源对象都可以通过Kubernetes提供的kubectl工具（或者API编程调用）执行增、删、改、查等操作并将其保存在etcd中持久化存储。
从这个角度来看，Kubernetes其实是一个高度自动化的资源控制系统，它通过跟踪对比etcd库里保存的“资源期望状态”与当前环境中的“实际资源状态”的差异来实现自动控制和自动纠错的高级功能
```

#### apiVersion
> 定义一个pod资源

```yaml
apiVersion: v1
kind: Pod
metadata: 
  name: mywebapp
  labels: 
    name: mywebapp
spec:
  containers:
  - name: mywebapp
    image: kubeguide/tomcat-app:v1
    ports:
    - containetPort: 8080
```

> apiVersion说明

- Kubernetes平台采用了“核心+外围扩展”的设计思路，在保持平台核心稳定的同时具备持续演进升级的优势。
- Kubernetes大部分常见的核心资源对象都归属于v1这个核心API，比如Node、Pod、Service、Endpoints、Namespace、RC、PersistentVolume等。
- 在版本迭代过程中，Kubernetes先后扩展了extensions/v1beta1、apps/v1beta1、apps/v1beta2等API组，而在1.9版本之后引入了apps/v1这个正式的扩展API组，正式淘汰（deprecated）了extensions/v1beta1、apps/v1beta1、apps/v1beta2这三个API组

> k8s注解说明

```yaml
apiVersion: v1
kind: Pod
metadata: 
  name: mywebapp
  labels: 
    name: mywebapp
  annotations:
    pod.beta.kubernates.io/init-contsainers: '[
      {
          "name": "init-mydb",
          "image": "busybox",
          "command": []
      }
    ]'
spec:
  containers:
  - name: mywebapp
    image: kubeguide/tomcat-app:v1
    ports:
    - containetPort: 8080
```

- 在Kubernetes 1.8版本以后，Init container特性完全成熟，其定义被放入Pod的spec.initContainers一节，看起来优雅了很多：

```yaml
apiVersion: v1
kind: Pod
metadata: 
  name: mywebapp
  labels: 
    name: mywebapp 
spec:
  initContainers:
  - name: init-mydb 
    image: busyboy 
    command:  
    - xxx
```

### k8s核心节点
#### Master节点关键进程
- kube-apiserver: 提供了HTTP Rest接口的关键服务进程，是Kubernetes里所有资源的增、删、改、查等操作的唯一入口，也是集群控制的入口进程
- kube-controller-manager: Kubernetes里所有资源对象的自动化控制中心，可以将其理解为资源对象的“大总管”
- kube-schedule: 负责资源调度（Pod调度）的进程，相当于公交公司的“调度室”
- etcd服务：存储所有数据服务的基本信息，实现注册与服务发现

#### Node节点进程
- kubelet: 负责Pod对应的容器的创建、启停等任务，同时与Master密切协作，实现集群管理的基本功能
- kube-proxy: 实现Kubernetes Service的通信与负载均衡机制的重要组件
- Docker Engine: Docker引擎，负责本机的容器创建和管理工作

> 查看集群的node节点

```shell script
kubectl get nodes
```

> 查看node的详细信息

```shell script
kubectl describe node node_name
```

#### Pod资源

> Pod节点之间的通讯基于虚拟二层网络技术实现(Flannel/OpenvSwitch)

![](/Users/keithl/docker/data/xiaokunliu.github.io/websites/zimages/k8s/02/k8s_pod_network01.jpg)

> 定义pod的资源描述信息

```yaml
## 定义apiVersion
apiVersion: v1
## 定义资源为pod类型
kind: pod	
## 定义metadata
metadata:
	name: myweb		## pod的名称
	labels: 
		name: myweb	## 给pod打标签,可以通过selector进行label选择
## 在Pod里所包含的容器组的定义则在spec
spec:
	containers:
	- name: myweb
	  image: kubeguide/tomcat-app:v1
	  ports:
	  - containerPort: 8080
	  env:
	  - name: MYSQL_SERVICE_HOST
	    value: 'mysql'
	  - name: MYSQL_SERVICE_PORT:
			value: '3306'	
```

